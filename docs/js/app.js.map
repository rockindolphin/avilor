{"version":3,"sources":["app.js"],"names":["$","document","ready","replaceTag","elem","newTag","attrs","rez","append","contents","map","attrName","attr","each","find","replaceWith","productOpen","svg4everybody","error","console","log","scrollMeasure","addClass","get","scrollbarWidth","offsetWidth","clientWidth","css","marginRight","click","toggleClass","li","closest","length","on","e","is","target","off","config","allow_single_deselect","disable_search_threshold","no_results_text","width","selector","chosen","src","parent","currentSrc","hide","frontSliderPics","Swiper","slidesPerView","slideChange","frontSliderText","slideTo","activeIndex","pagination","el","type","navigation","nextEl","prevEl","rellax","Rellax","modalHtml","loadProductData","product","fields","field","html","remove","barcode","text","prepend","toggleProductModal","scrolltop","scrollTop","documentElement","animate","evt","preventDefault","getFilterCriterias","criterias","parseInt","val","filterProducts","visibleTotal","group","products","visibleItems","visible","key","node","show","items","item","bad","push","change","jQuery"],"mappings":"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","file":"app.js","sourcesContent":["(function($){\r\n\t$(document).ready(function() {\r\n\t\t//костыль для drupal\r\n\t\tfunction replaceTag(elem,newTag,attrs){\r\n\t\t\tvar rez = $('<'+newTag+' />').append( $(elem).contents() );\r\n\t\t\tattrs.map(function(attrName){\r\n\t\t\t\t$(rez).attr(attrName, $(elem).attr(attrName));\r\n\t\t\t});\r\n\t\t\treturn rez;\r\n\t\t}\r\n\t\t$('ul[class^=chosen-]').each(function(){\r\n\t\t\t$(this).find('li').replaceWith(function(){\r\n\t\t\t\treturn replaceTag(this,'option',['value']);\r\n\t\t\t});\t\r\n\t\t\t$(this).replaceWith(function(){\r\n\t\t\t\treturn replaceTag(this,'select',['data','class','tabindex']);\r\n\t\t\t});\t\r\n\t\t});\r\n\t\t$('.product__filter').each(function(){\r\n\t\t\t$(this).find('dt').replaceWith(function(){\r\n\t\t\t\treturn replaceTag(this,'input',['class','type', 'value', 'id', 'name', 'checked']);\r\n\t\t\t});\r\n\t\t\t$(this).find('dd').replaceWith(function(){\r\n\t\t\t\treturn replaceTag(this,'label',['class','for']);\r\n\t\t\t});\r\n\t\t});\t\t\r\n\t\t\r\n\t\tvar productOpen = false;\r\n\r\n\t\t//внешние svg в ie11\r\n\t\ttry{\r\n\t\t\tsvg4everybody();\r\n\t\t}catch(error){\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\r\n\t\t//ширина скроллбара\r\n\t\tvar scrollMeasure = $('<div>').addClass('scroll__measure').get(0);\r\n\t\t$('body').append(scrollMeasure);\r\n\t\tvar scrollbarWidth = scrollMeasure.offsetWidth - scrollMeasure.clientWidth;\r\n\t\t$(':root').css('--scrollbar-width', scrollbarWidth+'px');\r\n\t\tif( scrollbarWidth > 0 ){\r\n\t\t\t$('.scroll--cutt').css({\r\n\t\t\t\tmarginRight: -scrollbarWidth\r\n\t\t\t});\t\t\r\n\t\t}\r\n\r\n\t\t//меню в шапке\r\n\t\t$('.header__menu-btn button').click(function(){\r\n\t\t\tif( !productOpen ){\r\n\t\t\t\t$('.page__header').toggleClass('header--menu-open');\t\t\r\n\t\t\t\t$('.page').toggleClass('scroll--locked');//disable page scroll\t\t\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//подменю\r\n\t\t$('.header__menu-list .btn').click(function(){\r\n\t\t\tvar li = $(this).closest('.list__item');\r\n\t\t\tif( $(li).find('.list').length > 0 ){\r\n\t\t\t\t$(li).toggleClass('item--active-trail');\r\n\t\t\t}\r\n\t\t});\t\r\n\r\n\t\t//disable outline on click\r\n\t\t$(\"body\").on(\"mousedown\", \"*\", function(e) {\r\n\t\t\tif (($(this).is(\":focus\") || $(this).is(e.target)) && $(this).css(\"outline-style\") == \"none\") {\r\n\t\t\t\t$(this).css(\"outline\", \"none\").on(\"blur\", function() {\r\n\t\t\t\t\t$(this).off(\"blur\").css(\"outline\", \"\");\r\n\t\t\t\t});\r\n\t\t\t}\t\t\r\n\t\t});\t\r\n\r\n\t\t//chosen\r\n\t\tvar config = {\r\n\t\t\t'.chosen-select'           : {},\r\n\t\t\t'.chosen-select-deselect'  : { allow_single_deselect: true },\r\n\t\t\t'.chosen-select-no-single' : { disable_search_threshold: 10 },\r\n\t\t\t'.chosen-select-no-results': { no_results_text: 'Ничего не найдено' },\r\n\t\t\t'.chosen-select-width'     : { width: '95%' }\r\n\t\t};\r\n\t\tfor (var selector in config) {\r\n\t\t\t$(selector).chosen(config[selector]);\r\n\t\t}\r\n\r\n\r\n\t\t//section bg\r\n\t\t$('img[data-bg=true]').each(function(){\r\n\t\t\tvar src = $(this).attr('src');\r\n\t\t\tvar parent = $(this).parent();\r\n\t\t\tif( $(parent).is('picture') ){\r\n\t\t\t\tsrc = $(parent).find('img').get(0).currentSrc;\r\n\t\t\t\tparent =  $(parent).parent();\r\n\t\t\t}\r\n\t\t\t$(parent).css({\r\n\t\t\t\t'background-image': `url(${src})`\r\n\t\t\t});\r\n\t\t\t$(this).hide();\r\n\t\t});\r\n\r\n\t\t//slider\r\n\t\tvar frontSliderPics = new Swiper('.slider--front-pics .swiper-container', {\r\n\t\t\tslidesPerView: 1,\r\n\t\t\ton: {\r\n\t\t\t\tslideChange: function(){\r\n\t\t\t\t\tfrontSliderText.slideTo( this.activeIndex );\r\n\t\t\t\t} \r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tvar frontSliderText = new Swiper('.slider--front-text .swiper-container', {\r\n\t\t\tpagination: {\r\n\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\ttype: 'bullets',\r\n\t\t\t},\r\n\t\t\tnavigation: {\r\n\t\t\t\tnextEl: '.swiper-button-next',\r\n\t\t\t\tprevEl: '.swiper-button-prev',\r\n\t\t\t},\r\n\t\t\ton: {\r\n\t\t\t\tslideChange: function(){\r\n\t\t\t\t\tfrontSliderPics.slideTo( this.activeIndex );\r\n\t\t\t\t} \t\t\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//параллакс\r\n\t\tif( $('.parallax__layer').length > 0 ){\r\n\t\t\tvar rellax = new Rellax('.parallax__layer');\t\r\n\t\t}\r\n\r\n\t\t//продукты\r\n\t\tvar modalHtml =\t\r\n`<div class=\"blog blog--wide\">\r\n\t<div class=\"modal product__modal\">\r\n\t\t<div class=\"wrapper page__wrapper\">\r\n\t\t\t<div class=\"text--right\">\r\n\t\t\t\t<button class=\"btn btn--clr product__btn\">\r\n\t\t\t\t\t<svg class=\"icon icon--active icon--close\">\r\n\t\t\t\t\t\t<use xlink:href=\"#close\"></use>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"product product--open\">\r\n\t\t\t\t<div class=\"text--center\">\r\n\t\t\t\t\t<h4 class=\"product__title\"></h4>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"product__pic\"></div>\r\n\t\t\t\t<div class=\"product__barcode\"></div>\r\n\t\t\t\t<div class=\"product__excerpt\"></div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>`;\r\n\t\t\r\n\t\tfunction loadProductData(product){\r\n\t\t\tvar productOpen = $('.product--open');\r\n\t\t\tvar fields = ['title','barcode','pic','excerpt'];\r\n\t\t\tfields.map(function(field){\r\n\t\t\t\t$(productOpen).find(`.product__${field}`).html('').html( $(product).find(`.product__${field}`).html() );\r\n\t\t\t});\r\n\t\t\t$(productOpen).find('.product__badges').remove();\r\n\t\t\tvar barcode = $(productOpen).find('.product__barcode');\r\n\t\t\tif( $(barcode).text().length > 0 ){\r\n\t\t\t\t$(productOpen).find('.product__excerpt').prepend(`<h6>Штрих-код</h6><p>${ $(barcode).text() }</p>`);\r\n\t\t\t\t$(barcode).hide();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction toggleProductModal(){\r\n\t\t\tvar scrolltop;\r\n\t\t\tif( !productOpen ){\r\n\t\t\t\tscrollTop = document.documentElement.scrollTop;\r\n\t\t\t}\r\n\t\t\t$('.page').toggleClass('page--product-open');\r\n\t\t\t$('.product__modal').toggleClass('modal--open');\r\n\t\t\t$('.page__main>.page__wrapper').toggleClass('item--hidden');\r\n\t\t\tif( !productOpen ){\r\n\t\t\t\t$('html, body').animate({\r\n\t\t\t\t\tscrollTop: 0\r\n\t\t\t\t}, 400);\t\t\t\r\n\t\t\t}\t\t\t\r\n\t\t\tif( productOpen ){\r\n\t\t\t\tdocument.documentElement.scrollTop = scrollTop;\r\n\t\t\t}\t\t\t\t\t\r\n\t\t\tproductOpen = !productOpen;\r\n\t\t}\r\n\r\n\t\tvar scrollTop = 0;\r\n\t\tif( $('.product[data-modal=\"product\"]').length > 0 ){\r\n\t\t\t\r\n\t\t\t$('.page__main').append(modalHtml);\r\n\r\n\t\t\t$('.product[data-modal=\"product\"]').click(function(evt){\r\n\t\t\t\tevt.preventDefault();\r\n\t\t\t\tloadProductData(this);\r\n\t\t\t\ttoggleProductModal();\r\n\t\t\t});\r\n\r\n\t\t\t$('.header__menu-btn button').click(function(evt){\r\n\t\t\t\tif( productOpen ){\r\n\t\t\t\t\ttoggleProductModal();\r\n\t\t\t\t\tevt.preventDefault();\t\t\r\n\t\t\t\t}\r\n\t\t\t});\t\r\n\r\n\t\t\t$('.product__btn').click(function(){\r\n\t\t\t\ttoggleProductModal();\r\n\t\t\t});\t\r\n\t\t}\r\n\r\n\t\t//возвращает скритерии для фильтрации со значениями\r\n\t\tfunction getFilterCriterias(){\r\n\t\t\tvar criterias = {};\r\n\t\t\tif( $('#group_filter').length === 1 ){\r\n\t\t\t\tcriterias['group'] = parseInt($('#group_filter').val());\r\n\t\t\t\tif(criterias['group'] === 0){\r\n\t\t\t\t\tdelete criterias['group'];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif( $('#bad_filter').length === 1 ){\r\n\t\t\t\tcriterias['bad'] = $('#bad_filter input:checked').attr('value') === 'bad';\r\n\t\t\t}\r\n\t\t\treturn criterias;\t\t\t\r\n\t\t}\r\n\r\n\t\t// скрывает/показывает продукты/группы продуктов взависимости от критериев\r\n\t\tfunction filterProducts(){\r\n\t\t\tvar criterias = getFilterCriterias();\r\n\t\t\tconsole.log(criterias);\r\n\t\t\tvar visibleTotal = 0;\r\n\t\t\tfor( var group in products ){\r\n\t\t\t\tvar visibleItems = 0;\r\n\t\t\t\tproducts[group]['items'].map(function(product){\r\n\t\t\t\t\tproduct.visible = true;\r\n\t\t\t\t\tfor( var key in criterias){\r\n\t\t\t\t\t\tproduct.visible = product.visible && (criterias[key] === product[key]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( product.visible ){\r\n\t\t\t\t\t\t$(product.node).show(400);\r\n\t\t\t\t\t\tvisibleItems++;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t$(product.node).hide(400);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif( visibleItems > 0 ){\r\n\t\t\t\t\t$(products[group]['node']).show(400);\r\n\t\t\t\t\tvisibleTotal++;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t$(products[group]['node']).hide(400);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif( visibleTotal > 0 ){\r\n\t\t\t\t$('#no-results').hide();\r\n\t\t\t}else{\r\n\t\t\t\t$('#no-results').show();\t\t\t\t\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\r\n\t\tvar products = {};\r\n\t\t$('.product__group-wrapper').each(function(){//парсим продукты\r\n\t\t\tvar group = parseInt($(this).attr('data-group'));\r\n\t\t\tproducts[group] = { node: this, items: [] };\r\n\t\t\t$(this).find('.product').each(function(){\r\n\t\t\t\tvar item = {\r\n\t\t\t\t\tnode: this,\r\n\t\t\t\t\tgroup: group,\r\n\t\t\t\t\tbad: $(this).attr('data-bad') === 'true',\r\n\t\t\t\t\tproduct: $(this).attr('data-product') === 'true',\r\n\t\t\t\t\tvisible: true,\r\n\t\t\t\t};\r\n\t\t\t\tproducts[group].items.push(item);\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t$('#group_filter, #bad_filter').change(function(){\r\n\t\t\tfilterProducts();\r\n\t\t});\r\n\t\tfilterProducts();\r\n\r\n\t});\t\r\n\r\n})(jQuery);"]}